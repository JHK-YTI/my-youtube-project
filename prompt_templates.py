# prompt_templates.py
import config

# =================================================================
# ▼▼▼▼▼ 이미지 프롬프트 생성 (수정 없음) ▼▼▼▼▼
# =================================================================

IMAGEFX_PROMPT = """너는 주어진 대본을 바탕으로, AI 이미지 생성 도구(Midjourney, DALL-E)에서 사용할 '실사 느낌'의 프롬프트를 만드는 전문 프롬프트 엔지니어야.
아래 [작업 원칙]에 따라, 주어진 [대본]의 각 문장에 어울리는 이미지 생성 프롬프트를 장면별로 생성해줘.

[작업 원칙]
1.  **장면 분할:** 대본을 2~4초 분량의 짧은 단위로 나누어, **최소 8개 이상의 장면**을 순서대로 생성한다.
2.  **프롬프트 스타일:** 생성되는 이미지는 'cinematic, photorealistic, dramatic lighting, 8k, ultra-detailed' 스타일을 기본으로 한다.
3.  **프롬프트 내용:** 각 프롬프트는 아래 [스타일 가이드]로 시작해야 하며, 각 장면의 핵심 내용과 감정이 잘 드러나도록 구체적인 상황, 인물의 표정, 배경 등을 **영문으로** 상세히 묘사한다.
4.  **출력 형식:** 아래 [출력 예시]와 같이, 각 프롬프트를 '###'로 명확하게 구분하고 프롬프트 내용은 ```로 감싸서 다른 설명 없이 결과만 출력한다.

[스타일 가이드]
1:1 aspect ratio, cinematic photo of a korean person, photorealistic, 8k, ultra-detailed, dramatic lighting, 

[출력 예시]
### SCENE #1
1:1 aspect ratio, cinematic photo of a korean person, photorealistic, 8k, ultra-detailed, dramatic lighting, a high school hallway, a male student is backed against the lockers, looking scared and confused. In front of him, a girl with a tough expression is pointing at him.


### SCENE #2
1:1 aspect ratio, cinematic photo of a korean person, photorealistic, 8k, ultra-detailed, dramatic lighting, Close-up shot of the male student's hand holding a small, folded letter. His expression is a mix of fear and curiosity. soft lighting, detailed texture on the paper.


[대본]
{script}
"""

SSEOLTOON_PROMPT = """너는 주어진 대본을 바탕으로, '썰툰'이나 웹툰 스타일에 어울리는 AI 이미지 프롬프트를 만드는 전문 프롬프트 엔지니어야.
아래 [작업 원칙]에 따라, 주어진 [대본]의 각 문장에 어울리는 이미지 생성 프롬프트를 장면별로 생성해줘.

[작업 원칙]
1.  **장면 분할:** 대본을 2~4초 분량의 짧은 단위로 나누어, **최소 8개 이상의 장면**을 순서대로 생성한다.
2.  **프롬프트 스타일:** 생성되는 이미지는 '심플한 일러스트 스타일, 웹툰 아트, 깔끔한 선, 생생한 색감, 풍부한 표정'을 기본으로 한다.
3.  **프롬프트 내용:** 각 프롬프트는 아래 [스타일 가이드]로 시작해야 하며, 각 장면의 상황과 등장인물의 감정(놀람, 황당함, 설렘 등)이 과장되고 명확하게 드러나도록 **한국어로** 묘사한다.
4.  **출력 형식:** 아래 [출력 예시]와 같이, 각 프롬프트를 '###'로 명확하게 구분하고 프롬프트 내용은 ```로 감싸서 다른 설명 없이 결과만 출력한다.

[스타일 가이드]
(1:1 비율, 초고퀄 치비+모에 스타일의 일러스트, 한국형 웹툰 스타일, 섬세하고 자연스럽게 흐르는 머릿결, 옷의 리얼한 주름과 질감, 크고 빛나는 눈망울과 하이라이트, 디테일한 피부 톤 그라데이션, 과장된 표정, 뚜렷한 감정 표현, 고채도 컬러톤, 명확한 명암, 밝은 하얀 채광, 자연스러운 볼터치)

[출력 예시]
### SCENE #1
(1:1 비율, 초고퀄 치비+모에 스타일의 일러스트, 한국형 웹툰 스타일, 섬세하고 자연스럽게 흐르는 머릿결, 옷의 리얼한 주름과 질감, 크고 빛나는 눈망울과 하이라이트, 디테일한 피부 톤 그라데이션, 과장된 표정, 뚜렷한 감정 표현, 고채도 컬러톤, 명확한 명암, 밝은 하얀 채광, 자연스러운 볼터치) 사나운 표정의 여고생이 깜짝 놀란 표정의 범생이 남학생에게 사랑 고백을 하고 있다. 배경은 단순한 학교 복도.


### SCENE #2
(1:1 비율, 초고퀄 치비+모에 스타일의 일러스트, 한국형 웹툰 스타일, 섬세하고 자연스럽게 흐르는 머릿결, 옷의 리얼한 주름과 질감, 크고 빛나는 눈망울과 하이라이트, 디테일한 피부 톤 그라데이션, 과장된 표정, 뚜렷한 감정 표현, 고채도 컬러톤, 명확한 명암, 밝은 하얀 채광, 자연스러운 볼터치) 땀을 뻘뻘 흘리며 얼굴을 붉히고 있는 범생이 남학생의 얼굴 클로즈업, 머리 옆에는 커다란 물음표 말풍선이 떠 있다.


[대본]
{script}
"""

GENERATE_IMAGEFX_PROMPT = IMAGEFX_PROMPT
GENERATE_SSEOLTOON_PROMPT = SSEOLTOON_PROMPT


# =================================================================
# ▼▼▼▼▼ V4(입문자용) 상세 기획 대본 생성 (수정 없음) ▼▼▼▼▼
# =================================================================

SYSTEM_MESSAGE_COMMON = """
당신은 최고의 유튜브 쇼츠 대본 작가이자 각색 전문가입니다.
각 카테고리의 특성과 대중의 몰입 흐름을 완벽하게 이해하고 있으며, AI가 만든 티가 전혀 나지 않는 사람 냄새 나는 대본을 만들어야 합니다.

[공통 목표]
모든 응답은 ① 1인칭 시점, ② 자연스러운 감정 흐름, ③ 몰입도 높은 전개, ④ 강한 후킹과 임팩트 있는 결말을 반드시 갖춰야 합니다.

[공통 작성 규칙]
- "너무 AI 같지 않게" 만들어야 합니다. 기계적인 문장 패턴, 클리셰 사용 금지. (예: "요즘 마음이 힘들었어요" 같은 상투적인 문장 절대 금지)
- 반드시 반전, 깨달음, 유머, 공감, 놀람, 감동 중 최소 하나 이상 포함해야 합니다.
- 각 카테고리 특성에 맞는 문체, 리듬, 표현 방식을 따라야 합니다.
- 사용자의 반복 요청에도 항상 신선한 구성으로 응답해야 합니다.
"""

USER_MESSAGE_TEMPLATE_COMMON = """
[사용자 요청]
- 카테고리: {category}
- 핵심 주제: {topic}
- 톤앤매너: {tone}
- 주요 타겟: {target_audience}
- 영상 형식: {format}

[카테고리별 특별 지침]
{category_specific_guide}

위 모든 조건을 엄격하게 준수하여, 아래 [출력 형식]에 맞춰 쇼츠 대본 패키지를 생성해주세요.

[출력 형식]
[PRODUCTION_SCRIPT_START]
[도입]
(쇼츠의 인트로 파트)
[전개]
(감정과 정보가 들어가는 핵심 내용)
[하이라이트 또는 반전]
(놀라움, 충격, 깨달음의 순간)
[결말]
(한 줄 요약 또는 여운 있는 마무리)
[PRODUCTION_SCRIPT_END]
[STORYBOARD_START]
(장면별 콘티와 이미지 생성 프롬프트 예시)
[STORYBOARD_END]
[FOLLOWUP_TOPICS_START]
(후속 주제 3가지)
[FOLLOWUP_TOPICS_END]
"""

CATEGORY_GUIDES = {
    'ssultoon': "- 기억의 흐름처럼 자연스럽게 시작 (예: \"어느 날 아침에 눈 떴는데...\")\n- 말 끊기, 중얼거림, 감탄사, 의성어 적극 사용 (\"헉... 그 순간 진짜\", \"아니 근데...\")\n- 점점 복잡해지다가 단순하고 강한 반전으로 마무리",
    'community': "- 독자의 입장에서 \"내가 겪은 일\"처럼 실제 사연처럼 표현\n- 주장 아님! 오직 경험 묘사와 감정만 전달\n- 중간중간 심리 묘사 필수 (예: \"속으로 생각했죠. 아, 망했다.\")\n- 결말은 소소한 교훈 또는 허탈한 마무리 (예: \"그날 이후, 다시는 야식을 참지 않는다\")",
    'top_n': "- 도입은 의외성 있는 질문/사실로 시작 (예: “치킨보다 더 살찌는 간식, 뭔지 아세요?”)\n- 짧은 템포, 빠른 나열, 중간 추임새 (예. “이건 좀 의외죠?”)\n- 1위 발표 전에는 긴장감 있는 맥락 추가\n- 마지막은 실천 유도 (\"하루 한 개씩 줄여보는 거 어때요?\")",
    'knowledge': "- \"내가 이걸 몰라서 당한 일\" → \"알고 나서 인생이 바뀐 이야기\" 구조\n- 절대 설명 금지! 경험 기반 스토리만\n- 정보는 삶의 변화 안에서만 등장해야 함\n- 마무리는 \"여러분도 속는 셈 치고 해보세요.\" 같은 추천어",
    'review': "- 사용 전 단점 → 사용 후 변화 중심\n- 찬양 말고 솔직한 리액션 중심 후기\n- 가장 놀랐던 순간을 구체적으로 묘사\n- 결론은 \"진작 살 걸…\" 수준의 한 줄 요약",
    'religion': "- 단순 요약/설교 금지. 오직 간증/변화 중심\n- 주제가 인물이면: 그 인물의 실수, 회개, 변화에 공감하는 시점\n- 주제가 비유라면: 삶의 적용에 집중\n- 하나님의 도우심, 위로, 회복을 고백 형식으로 전달\n- 마지막은 짧은 기도 또는 묵상 문장",
    'emotion': "- 평범한 일상 속에서 느낀 감정이나 깨달음을 시적으로 표현\n- \"그날은 이상하게 모든 게 느리게 흘렀다\" 같은 도입\n- 내면의 흐름과 연결된 감성적 문장 필수\n- 결말은 열린 질문이나 여운 있는 한 줄"
}

PLANNER_PROMPTS = {
    category: {
        "system_message": SYSTEM_MESSAGE_COMMON,
        "user_message_template": USER_MESSAGE_TEMPLATE_COMMON.format(
            category="{category}",
            topic="{topic}",
            tone="{tone}",
            target_audience="{target_audience}",
            format="{format}",
            category_specific_guide=guide
        )
    } for category, guide in CATEGORY_GUIDES.items()
}

PLANNED_SCRIPT_PROMPT = """당신은 유튜브 쇼츠 콘텐츠를 종합 제작하는 올인원 프로듀서입니다. 사용자의 상세 요구사항을 바탕으로, 완전한 콘텐츠 패키지를 생성해주세요.
**[매우 중요한 기본 원칙] 모든 결과물은 반드시 자연스러운 '한국어'로만 작성해야 합니다. 영어를 절대 사용하지 마세요.**
[사용자 요구사항]
- **카테고리:** {category}
- **톤앤매너:** {tone}
- **영상 형식:** {format}
- **주요 타겟:** {target_audience}
- **핵심 주제/소재:** {topic}
[콘텐츠 제작 절대 원칙]
1.  **한국어 전용:** 모든 결과물은 어떠한 경우에도 **완벽한 한국어 구어체**로만 작성해야 합니다.
2.  **요구사항 완벽 반영:** 위 [사용자 요구사항]의 모든 조건이 결과물에 명확히 드러나도록 작성해야 합니다.
3.  **쇼츠 문법 준수:**
    -   **강력한 후킹:** 첫 1~2 문장은 시청자의 시선을 즉시 사로잡을 수 있는 가장 강력한 문장으로 시작해야 합니다.
    -   **빠른 기승전결:** 30~60초 분량에 맞춰, 서론-본론-결론이 명확한 압축적인 스토리텔링 구조를 가져야 합니다.
4.  **AI 제작 가능성:** 모든 내용은 실제 촬영 없이, AI 음성(TTS)과 AI 이미지 생성만으로 영상화가 가능해야 합니다.
5.  **편집자용 주석 포함:** 제작용 대본에는 영상 편집에 도움이 될만한 주석을 (자막 강조), (빠른 화면 전환), (인물 클로즈업)과 같은 형식으로 자연스럽게 삽입해주세요.
[출력 형식 엄수]
아래 지정된 구분자(Delimiter)를 사용하여 각 섹션을 명확히 구분하고, 다른 설명 없이 결과물만 생성해주세요.
[TTS_SCRIPT_START]
(이곳에는 TTS 서비스에 사용할 **오직 한국어 나레이션 텍스트**만 깔끔하게 작성하세요. '나레이터:' 같은 역할 표시나 '(자막 강조)' 같은 주석은 모두 제거해야 합니다.)
[TTS_SCRIPT_END]
[PRODUCTION_SCRIPT_START]
(이곳에는 역할 표시와 편집용 주석이 모두 포함된, 완전한 **한국어 제작용 대본**을 작성하세요.)
[PRODUCTION_SCRIPT_END]
[STORYBOARD_START]
(제작용 대본의 각 장면에 어울리는 콘티와 AI 이미지 프롬프트 예시를 제안해주세요.)
[STORYBOARD_END]
[FOLLOWUP_TOPICS_START]
(이 영상의 후속편으로 제작할 만한 영상 주제 3가지를 **한국어로** 제안해주세요.)
[FOLLOWUP_TOPICS_END]
"""


# =================================================================
# ▼▼▼▼▼ 기타 분석 레시피 (수정 없음) ▼▼▼▼▼
# =================================================================

TREND_CATEGORY_PROMPT = """너는 최신 유튜브 트렌드 분석 전문가이다.
오늘은 {current_date}이다.
현재 유튜브에서 가장 인기 있는 영상 카테고리 5개를, 각 카테고리별로 사람들이 흥미를 느끼는 이유와 함께 제안해줘.
결과는 다른 설명 없이, 아래와 같은 JSON 형식으로만 출력해줘.

[출력 형식]
{{
  "categories": [
    {{
      "category_name": "(카테고리 이름 1)",
      "reason": "(인기 있는 이유 1)"
    }},
    {{
      "category_name": "(카테고리 이름 2)",
      "reason": "(인기 있는 이유 2)"
    }},
    {{
      "category_name": "(카테고리 이름 3)",
      "reason": "(인기 있는 이유 3)"
    }},
    {{
      "category_name": "(카테고리 이름 4)",
      "reason": "(인기 있는 이유 4)"
    }},
    {{
      "category_name": "(카테고리 이름 5)",
      "reason": "(인기 있는 이유 5)"
    }}
  ]
}}
"""

TOPIC_WITHIN_CATEGORY_PROMPT = """너는 창의적인 유튜브 콘텐츠 아이디어 작가다.
주어진 [카테고리] 내에서, 사람들이 흥미를 느낄 만한 구체적인 영상 주제를 5개 제안해줘.
결과는 다른 설명 없이, 아래 예시처럼 각 줄에 주제만 깔끔하게 나열해줘.

[카테고리]
{category}

[영상 주제 예시]
- 오늘의 경제 뉴스, 1분 안에 핵심만 짚어드림
- 주식 초보를 위한 MTS 사용법 A to Z
- 요즘 가장 핫한 미국 기술주, 지금 사도 될까?
"""

# ▼▼▼▼▼ [핵심 수정] ANALYSIS_PROMPT에 오류 방지 규칙 추가 ▼▼▼▼▼
ANALYSIS_PROMPT = """당신은 수많은 유튜브 채널을 성공시킨 최고의 '유튜브 콘텐츠 컨설턴트'입니다. 주어진 [원본 대본]을 아래의 [분석 프레임워크]에 따라 다각도로, 그리고 매우 구체적으로 분석해주세요. 피상적인 분석이 아닌, 당장 실행 가능한 해결책을 제시하는 것이 핵심입니다.

[절대 규칙: 출력 형식]
- 모든 응답은 반드시 순수한 텍스트와 마크다운(###, -, *)만으로 구성되어야 합니다.
- 응답에 절대로 HTML 태그, CSS 클래스, 또는 기타 프로그래밍 코드를 포함하지 마세요. 오직 텍스트로만 명확하고 간결하게 분석 내용을 전달해야 합니다.

[원본 대본]
{transcript_text}

---
[분석 프레임워크]

### 📈 1. 영상의 핵심 인기 요인
(이 대본이 가진 명확한 강점과 시청자에게 매력적인 포인트 2-3가지를 분석합니다. 예: '사회초년생'이라는 명확한 타겟팅, '신용카드'라는 현실적인 소재 등)

### 📉 2. 보완이 필요한 문제점
(이 대본의 구조, 내용, 재미 요소 등에서 아쉬운 점 2-3가지를 구체적으로 지적합니다. 예: 도입부가 너무 길고 지루함, 구체적인 사례나 데이터 부족 등)

### 🚀 3. 구체적인 개선 방안 (실행 가능한 아이디어)
- **[도입부 수정 제안]:** (시청자의 시선을 초반 5초 안에 사로잡을 더 강력한 후킹 문구를 2~3개 제안합니다.)
- **[스토리텔링 강화]:** (예: 실제 경험담 추가, 시청자 사연 활용 등 대본에 재미와 깊이를 더할 구체적인 아이디어를 제시합니다.)
- **[시청자 참여 유도]:** (예: 영상 중간에 던질 질문, 댓글을 유도할 마무리 멘트, 시청자가 참여할 챌린지 등을 제안합니다.)

### 📝 4. 최종 요약 및 실행 리스트 (Action Items)
(위 분석을 바탕으로, 이 영상의 성공을 위해 PD가 지금 당장 해야 할 가장 중요한 일 3가지를 리스트 형식으로 요약하여 명령합니다.)
"""
# ▲▲▲▲▲ [핵심 수정] ▲▲▲▲▲


CORRECTION_PROMPT = """당신은 문장 교정 전문가입니다. 아래 [대본 원본]은 음성을 텍스트로 변환한 결과라 오타나 어색한 부분이 많을 수 있습니다. 문맥을 자연스럽게 파악하여, 다음 규칙에 따라 오직 교정만 수행하세요.
[규칙]
- 명백한 오타를 수정합니다.
- 문법과 띄어쓰기를 정확하게 교정합니다.
- 내용의 추가, 삭제, 요약은 절대 하지 않습니다.
- 원본의 구어체 느낌은 최대한 유지합니다.
[대본 원본]
{transcript_text}
[완벽하게 교정된 대본]
"""

REWRITE_V4_STEP1_ANALYZE = """당신은 천재적인 유튜브 쇼츠 기획자입니다. 당신의 임무는 [원본 대본]을 분석하여, 이 대본을 '최상위' 수준으로 각색하기 위한 완벽한 '작전 계획'을 수립하는 것입니다.

**[분석 대상]**
{original_script}

---
**[작전 계획 수립 가이드]**

**1. 원본 콘텐츠 유형 분류:**
   - [원본 대본]의 내용과 형식을 분석하여, 아래 4가지 유형 중 가장 적합한 것 하나를 선택하고 그 이유를 간략히 설명하세요.
     - [유형 A] 커뮤니티 유머 글: 온라인 커뮤니티의 게시글처럼 재미 위주의 내용을 다룸.
     - [유형 B] 개인적인 경험담 (썰): 특정 인물의 실제 경험이나 일화를 중심으로 전개됨.
     - [유형 C] 전문 지식/정보 전달: 특정 분야의 지식, 노하우, 팁 등을 객관적으로 설명함.
     - [유형 D] 상품/서비스 리뷰: 특정 제품이나 서비스의 장단점을 평가하고 후기를 전달함.

**2. 각색 페르소나 설정:**
   - 위에서 분류한 콘텐츠 유형에 가장 잘 어울리는 '화자(페르소나)'를 아래 보기에서 선택하고, 그 이유를 설명하세요.
     - [페르소나 1] 옆집 형/언니: 친근하고 유머러스하며, 반말과 구어체를 사용하여 생생한 경험담을 전달하는 데 적합.
     - [페르소나 2] 냉철한 분석가: 객관적이고 논리적인 톤으로, 정확한 정보나 비교 분석 결과를 전달하는 데 적합.
     - [페소르나 3] 따뜻한 조언가: 다정하고 공감하는 어조로, 시청자에게 위로나 격려, 유용한 팁을 전달하는 데 적합.

**3. 스토리텔링 공식 선택:**
   - 설정된 페르소나와 콘텐츠 유형을 바탕으로, 가장 효과적인 '이야기 공식'을 아래 보기에서 선택하고, 그 이유를 설명하세요.
     - [공식 A] 문제 해결형: 시청자의 고충을 보여주고, 그에 대한 명쾌한 해결책을 제시.
     - [공식 B] 개인 경험담 (썰 풀기): "내가 ~했던 이야기" 형식으로 시간 순서에 따라 재미있게 전개.
     - [공식 C] 통념 반박형: "사실 그게 아닙니다!"라며 기존 상식을 뒤집어 호기심을 자극.
     - [공식 D] 비교 분석형: 두 대상을 명확한 기준으로 비교하여 장단점을 명확히 전달.
     - [공식 E] TOP 리스트형: "TOP 3", "5가지 이유"처럼 정보를 목록으로 정리하여 전달.

---
이제, 위의 가이드에 따라 '작전 계획'을 보고서 형식으로 간결하게 작성해주세요. 각 항목(유형, 페르소나, 공식)에 대한 선택과 그 이유가 명확히 드러나야 합니다.
"""

REWRITE_V4_STEP2_DRAFT = """당신은 방금 수립된 [작전 계획]을 바탕으로 글을 쓰는 A급 유튜브 쇼츠 작가입니다.

**[작전 계획]**
{analysis_report}

**[원본 대본의 핵심 아이디어]**
{original_script}

---
**[초안 작성 지시사항]**

1.  **작전 계획 절대 준수:** 위 [작전 계획]에서 결정된 '페르소나'와 '이야기 공식'에 맞춰, 1분 내외의 새로운 유튜브 쇼츠 대본 초안을 작성하세요.
2.  **핵심 아이디어만 벤치마킹:** [원본 대본의 핵심 아이디어]만 참고하되, 문장, 전개 방식, 결말은 완전히 새롭게 창작해야 합니다. 절대 원본을 그대로 베끼거나 요약해서는 안 됩니다.
3.  **사실 기반 작성 (매우 중요):** 만약 원본이 '전문 지식/정보' 유형이라면, 절대 원본에 없는 수치, 인물, 연구 결과 등을 지어내지 마세요. 당신의 역할은 '창작'이 아닌 '쉽게 설명하는 것'입니다.
4.  **강력한 후킹:** 초반 3초 안에 시청자를 사로잡을 수 있는 강력한 도입부로 시작하세요.

---
이제, 위의 모든 지시사항을 준수하여, 오직 '초안 대본'만 군더더기 없이 작성해주세요.
"""

REWRITE_V4_STEP3_REVISE = """당신은 자신이 쓴 글을 냉정하게 평가하고 개선하는 최고의 '스크립트 닥터'입니다. 아래의 [초안 대본]은 당신이 방금 작성한 글입니다.

**[초안 대본]**
{draft_script}

**[최초 작전 계획]**
{analysis_report}

---
**[퇴고 지시사항]**

1.  **자기 비평:** [초안 대본]을 [최초 작전 계획]에 비추어 스스로 평가하고, 아래 항목에 대한 '개선점'을 찾아내세요.
    - **후킹:** 도입부가 충분히 강력하고 흥미로운가? 더 자극적이거나 공감대를 형성할 방법은 없는가?
    - **전개 속도:** 너무 늘어지거나, 반대로 너무 급하게 전개되지는 않는가?
    - **결말 임팩트:** 결말이 밋밋하지 않은가? 더 강력한 반전이나 명쾌한 해결책을 제시할 수는 없는가?
    - **페르소나 일관성:** 설정된 페르소나의 말투와 톤이 대본 전체에서 일관되게 유지되는가?

2.  **최종 원고 작성:** 위에서 스스로 찾아낸 '개선점'을 모두 반영하여, [초안 대본]을 수정한 **'최종 완성본 대본'**을 작성해주세요.

---
이제, 위의 지시사항에 따라 오직 **'최종 완성본 대본'**만 군더더기 없이 작성해주세요. 다른 설명은 절대 추가하지 마세요.
"""

REWRITE_V4_STEP4_GUIDE = """당신은 초보 유튜버를 위한 영상 제작 가이드를 만드는 친절한 컨설턴트입니다.

**[완성된 대본]**
{final_script}

---
**[제작 가이드 생성 지시사항]**

1.  **장면 나누기:** [완성된 대본]의 흐름에 맞춰 3~5개의 핵심 장면으로 나누세요.
2.  **현실적인 소스 제안:** 각 장면에 사용할 영상 소스를 제안하되, 아래의 **'초보자용 소스 원칙'**을 반드시 준수해야 합니다.
    - **'초보자용 소스 원칙':**
        - ✅ **허용:** 무료 스톡 영상/이미지(Pexels, Pixabay 등), 재미있는 인터넷 밈(짤), 간단한 스마트폰 촬영, PC 화면 녹화
        - ❌ **금지:** 전문적인 스튜디오 촬영, 유료 에셋, 복잡한 3D 그래픽, 드론 촬영 등 초보자가 구현하기 어려운 모든 것
3.  **자막 내용 작성:** 각 장면에 표시될 핵심 자막 내용을 간결하게 작성해주세요.

---
**[출력 형식]** (아래 형식을 반드시 그대로 지켜서 출력해주세요)

### 장면 1: (장면의 핵심 내용 요약)
- **추천 영상 소스:** (여기에 위 원칙에 맞는 소스 예시 작성)
- **핵심 자막:** (여기에 자막 내용 작성)

### 장면 2: (장면의 핵심 내용 요약)
- **추천 영상 소스:** (여기에 위 원칙에 맞는 소스 예시 작성)
- **핵심 자막:** (여기에 자막 내용 작성)

### 장면 3: (장면의 핵심 내용 요약)
- **추천 영상 소스:** (여기에 위 원칙에 맞는 소스 예시 작성)
- **핵심 자막:** (여기에 자막 내용 작성)
"""

GENERATE_METADATA_PROMPT = """당신은 수백만 조회수를 만드는 '유튜브 제목 컨설턴트'입니다.
주어진 [대본]을 바탕으로, 아래의 [작업 단계]와 [출력 형식]을 **반드시 엄격하게 준수하여** 유튜브 영상의 메타데이터를 생성해주세요.

**[작업 단계]**

1.  **[대본 분석]**
    -   대본의 핵심 주제와 키워드를 추출합니다.
    -   대본의 톤앤매너(예: 정보성, 후기, 유머)를 파악합니다.
    -   이 영상을 볼 것 같은 '타겟 시청자'를 **'초보자 그룹'**과 **'전문가 그룹'**으로 가상 설정합니다.

2.  **[제목 생성]**
    -   위 분석을 바탕으로, 각기 다른 컨셉과 소구점을 가진 **5가지의 매력적인 일반 추천 제목**을 생성합니다.
    -   각 제목이 어떤 전략(예: 호기심 자극, 문제 해결 강조)을 사용했으며, 어떤 시청자에게 효과적일지 **반드시 간략한 설명**을 덧붙입니다.
    -   '초보자 그룹'만을 위한 **쉽고 직관적인 제목 2개**를 추가로 생성합니다.
    -   '전문가 그룹'만을 위한 **신뢰감 있고 깊이 있는 제목 2개**를 추가로 생성합니다.

3.  **[해시태그 생성]**
    -   영상 내용과 관련된 핵심 키워드, 연관 키워드를 조합하여 **10개의 추천 해시태그**를 생성합니다.

**[대본]**
{script}

---

**[출력 형식]** (아래 형식을 반드시 그대로 지켜서 출력해주세요)

### 💡 AI 추천 제목 (일반)

1.  **(여기에 첫 번째 제목 작성)**
    -   **전략:** (여기에 해당 제목의 제작 의도 및 전략 설명)
2.  **_ (두 번째 제목과 전략 설명) _**
3.  **_ (세 번째 제목과 전략 설명) _**
4.  **_ (네 번째 제목과 전략 설명) _**
5.  **_ (다섯 번째 제목과 전략 설명) _**

### 🎯 타겟별 맞춤 제목

-   **초보자용:**
    1.  (여기에 초보자용 첫 번째 제목 작성)
    2.  (여기에 초보자용 두 번째 제목 작성)
-   **전문가용:**
    1.  (여기에 전문가용 첫 번째 제목 작성)
    2.  (여기에 전문가용 두 번째 제목 작성)

### #️⃣ 추천 해시태그
# (키워드 1) # (키워드 2) # (키워드 3) # (키워드 4) # (키워드 5) # (키워드 6) # (키워드 7) # (키워드 8) # (키워드 9) # (키워드 10)
"""

COMPARE_SCRIPTS_PROMPT = """당신은 전문 스크립트 에디터이자 분석가입니다. 아래의 [수정 전 대본]과 [수정 후 대본]을 비교하고, 어떤 핵심적인 변화가 있었는지 다음 항목에 맞춰 간결하게 요약해주세요.

-   **핵심 변경사항:** (가장 중요한 변화 1~2가지를 한 문장으로 요약)
-   **세부 변경내용:**
    -   (첫 번째 변경점: 예를 들어, 도입부의 임팩트를 강화함)
    -   (두 번째 변경점: 예를 들어, 감정 표현을 더 구체적으로 수정함)
    -   (세 번째 변경점: 예를 들어, 결말에 작은 반전을 추가함)

[수정 전 대본]
{script_before}

[수정 후 대본]
{script_after}
---
이제, 위의 형식에 맞춰 변경점 분석 결과만 군더더기 없이 작성해주세요:
"""

CHANNEL_ANALYSIS_PROMPT = """당신은 유튜브 채널 성장 전략 및 콘텐츠 컨설팅 전문가입니다. 제공된 [채널 정보]와 핵심 지표를 종합적으로 분석하여, 해당 채널의 **구체적인 강점, 개선 필요한 약점, 그리고 실질적이고 실행 가능한 성장 전략과 조언**을 제시해주세요. 피상적인 분석이 아닌, 깊이 있는 통찰력을 보여주는 것이 중요합니다.

[채널 정보]
{channel_info}

[분석 결과]
### 💪 채널의 핵심 강점 (구체적인 이유와 함께 2-3가지)
- 이 채널의 가장 두드러지는 강점은 무엇이며, 어떤 지표(구독자, 특정 영상 유형의 조회수, 최근 조회수 등)에서 이를 확인할 수 있습니까?
- 이 강점을 바탕으로 채널이 어떻게 성장할 수 있었는지 분석해주세요.

### 📉 개선이 필요한 약점 (구체적인 지표와 근거를 들어 2-3가지)
- 이 채널이 가진 약점은 무엇이며, 어떤 지표에서 아쉬운 점이 드러납니까? (예: 롱폼 영상의 낮은 평균 시청 시간, 불규칙한 업로드 주기, 특정 콘텐츠의 부재 등)
- 이러한 약점이 채널 성장에 어떤 부정적인 영향을 미칠 수 있는지 설명해주세요. (예: 불규칙한 업로드는 구독자 이탈 위험, 낮은 롱폼 시청 시간은 수익화 한계 등)

### 🚀 실질적인 성장 전략 및 조언 (구체적인 실행 방안 2-3가지)
- 강점을 더욱 극대화하고 약점을 보완하기 위한 구체적인 전략을 제시해주세요. (예: 숏폼 성공 요소를 롱폼에 결합, 특정 시간대에 정기적 업로드, 새로운 콘텐츠 포맷 시도 등)
- 필요하다면, 이 채널과 유사한 유형의 성공적인 채널을 벤치마킹하여 구체적인 사례나 아이디어를 언급해 주세요.
- 분석을 종합하여 이 채널이 다음 단계로 성장하기 위해 가장 우선적으로 고려해야 할 조언을 간결하게 제시해주세요.
"""

CREATE_CONTENT_PILLARS_PROMPT = """당신은 유능한 유튜브 채널 전략가입니다.
사용자가 자신의 채널에서 다루고 싶은 [핵심 주제]를 입력했습니다. 이 주제를 바탕으로, 채널의 정체성을 만들고 콘텐츠를 일관성 있게 확장해 나갈 수 있는 4개의 핵심 카테고리(콘텐츠 기둥)를 생성해주세요.
- 각 카테고리는 채널의 핵심 주제와 깊은 관련이 있어야 합니다.
- 각 카테고리 아래에는, 해당 카테고리에 맞는 구체적인 영상 주제 예시를 3개씩 포함해주세요.

- **핵심 주제:** {main_topic}

아래 [출력 형식]을 반드시 엄격하게 지켜서, 다른 설명 없이 결과만 생성해 주세요.

[출력 형식]
### [카테고리 1]
- 주제 1: (첫 번째 주제 예시)
- 주제 2: (두 번째 주제 예시)
- 주제 3: (세 번째 주제 예시)

### [카테고리 2]
- 주제 1: (첫 번째 주제 예시)
- 주제 2: (두 번째 주제 예시)
- 주제 3: (세 번째 주제 예시)

### [카테고리 3]
- 주제 1: (첫 번째 주제 예시)
- 주제 2: (두 번째 주제 예시)
- 주제 3: (세 번째 주제 예시)

### [카테고리 4]
- 주제 1: (첫 번째 주제 예시)
- 주제 2: (두 번째 주제 예시)
- 주제 3: (세 번째 주제 예시)
"""

EXPAND_PILLAR_TOPICS_PROMPT = """당신은 창의적인 유튜브 콘텐츠 아이디어 작가입니다.
주어진 [카테고리]에 대한 새로운 영상 아이디어를 5개 생성해주세요.
- **매우 중요:** 아이디어는 반드시 [기존 주제 목록]에 없는 새로워야 합니다.
- 아이디어는 주어진 [카테고리]의 통일성을 해치지 않아야 합니다.

- **카테고리:** {pillar_topic}
- **기존 주제 목록:**
{existing_topics}

아래 [출력 형식]을 반드시 엄격하게 지켜서, 다른 설명 없이 새로운 주제 5개만 생성해 주세요.

[출력 형식]
- 주제 1: (새로운 첫 번째 주제)
- 주제 2: (새로운 두 번째 주제)
- 주제 3: (새로운 세 번째 주제)
- 주제 4: (네 번째 주제)
- 주제 5: (새로운 다섯 번째 주제)
"""

PERFORMANCE_PREDICTION_PROMPT = """당신은 100만 조회수 이상의 유튜브 영상 10만 개를 분석한 데이터 과학자 '닥터 바이럴'입니다.
주어진 [대본]을 바탕으로, 이 영상의 성공 잠재력을 냉정하게 분석하고 점수를 매겨주세요.

**[분석 기준]**
1.  **흥미로운 도입부 (후킹):** 초반 5초 안에 시청자의 시선을 사로잡는가?
2.  **주제의 매력도:** 대중이 공감하거나 궁금해할 만한 주제인가?
3.  **스토리의 완성도:** 이야기 구조가 탄탄하고 기승전결이 명확한가?
4.  **정보의 가치:** 시청자가 영상을 보고 난 후, 유용한 정보나 재미를 얻어갈 수 있는가?
5.  **채널 성장 기여도:** '구독', '좋아요', '댓글' 등 시청자의 행동을 유도하는 장치가 있는가?

**[대본]**
{script_text}

---
이제, 위의 [분석 기준]에 따라 아래 [출력 형식]을 엄격하게 지켜서 리포트를 작성해주세요.

**[출력 형식]**
### 📈 AI 가상 성과 예측 리포트
- **종합 잠재력 점수:** (100점 만점 기준으로 점수만 간결하게)
- **점수 산정 근거:** (왜 이 점수가 나왔는지 1~2 문장으로 요약)

### 👍 강점 (Good Points)
- (위 분석 기준에 따라, 이 대본이 가진 명확한 강점 2가지를 분석)

### 👎 보완점 (Areas for Improvement)
- (위 분석 기준에 따라, 이 대본이 가진 아쉬운 점 2가지를 구체적으로 지적)

### 🚀 조회수 2배 올리는 꿀팁
- (분석 내용을 종합하여, 이 대본의 성공을 위해 지금 당장 실행할 수 있는 가장 효과적인 액션 아이템 1가지를 제안)
"""

BENCHMARKING_REPORT_PROMPT = """당신은 수많은 채널을 성공으로 이끈 유튜브 컨설팅 회사의 '수석 전략가'입니다.
[채널 기본 정보]와 이 채널의 [인기 영상 Top 5 대본 요약]을 종합적으로 분석하여, 이 채널의 성공 비결을 파헤치고 우리 채널에 적용할 수 있는 구체적인 전략을 도출해야 합니다.

**[채널 기본 정보]**
{channel_stats}

**[인기 영상 Top 5 제목]**
{top_video_titles}

**[인기 영상 Top 5 대본 요약]**
{top_video_transcripts}

---
위의 모든 정보를 바탕으로, 아래 [리포트 형식]을 반드시 엄격하게 지켜서 '경쟁 채널 벤치마킹 리포트'를 작성해주세요. 피상적인 분석이 아닌, 실행 가능한 날카로운 통찰력을 보여주는 것이 중요합니다.

**[리포트 형식]**

### 💎 채널 핵심 성공 전략
(채널의 기본 정보와 인기 영상들의 주제를 바탕으로, 이 채널이 타겟하는 핵심 시청자층과 그들을 사로잡는 가치 제안(Value Proposition)이 무엇인지 2~3 문장으로 분석해주세요.)

### 🔍 인기 콘텐츠 공식 분석
(인기 영상 Top 5의 대본을 분석하여, 이 채널이 반복적으로 사용하는 '성공 공식'을 아래 항목별로 구체적으로 분석해주세요.)
- **제목 공식:** (예: "OOO하는 3가지 방법"과 같이 숫자를 활용하여 구체성을 강조함, "절대 OOO하지 마세요"와 같이 시청자의 불안감을 자극함 등)
- **도입부 공식:** (예: 영상 시작 10초 안에 시청자가 얻을 이득을 명확히 제시함, 충격적인 질문으로 시작하여 호기심을 유발함 등)
- **구조 공식:** (예: 항상 3가지 소주제로 나누어 설명함, 스토리텔링 방식으로 문제 상황을 먼저 제시하고 해결책을 보여줌 등)

### 🚀 내 채널에 적용할 3가지 액션 아이템
(위 분석 내용을 바탕으로, 당장 내 채널의 다음 영상부터 바로 적용해볼 수 있는 구체적인 액션 아이템 3가지를 제안해주세요. 단순한 아이디어 제안이 아닌, '이렇게 한번 해보세요' 형태의 실행 계획이어야 합니다.)
- **액션 아이템 1:** (예: 다음 영상 도입부는 이 채널처럼 '만약 당신이 OOO이라면, 이 영상을 끝까지 보세요' 라는 문장으로 시작해보세요.)
- **액션 아이템 2:** (예: 이 채널의 핵심 키워드인 '가성비'를 우리 채널의 'OO' 주제와 결합하여 '가성비 OO 추천' 콘텐츠를 제작해보세요.)
- **액션 아이템 3:** (예: 영상 마지막에 이 채널처럼 다음 영상의 주제를 구체적으로 예고하여 시청자들의 재방문과 구독을 유도해보세요.)
"""

NAVIGATOR_PLAN_PROMPT = """당신은 유튜브 신규 채널의 컨셉을 잡아주는 '전문 인큐베이터'입니다.
사용자가 만들고 싶은 채널의 [핵심 주제]와, 영상의 [기획 각도]가 주어졌습니다. 이 두 가지를 조합하여, 유튜브 초보자가 즉시 제작에 착수할 수 있는 완벽한 '숏폼 영상 기획서' 1개를 생성해주세요.

**[매우 중요한 기획 원칙]**
1.  **'기획 각도' 충실히 반영:** 반드시 주어진 [기획 각도]의 컨셉과 내용에 맞춰 기획서를 작성해야 합니다.
2.  **바이럴 요소 포함:** 영상이 더 많이 퍼져나갈 수 있도록 '의외의 정보', '강력한 후킹 문구', '따라 하기 쉬운 행동' 등의 요소를 반드시 포함해야 합니다.
3.  **완결성:** 이 기획서 하나만으로 초보자가 영상 제작의 모든 단계를 이해할 수 있도록, 제목-대본-제작 가이드가 모두 포함된 완전한 결과물을 제공해야 합니다.

**[핵심 주제]**
{topic}

**[기획 각도]**
{selected_angle}

---
이제, 위의 모든 원칙을 준수하여 아래 [출력 형식]에 맞춰 '숏폼 영상 기획서'를 생성해주세요. 다른 설명 없이, 오직 기획서 내용만 깔끔하게 작성합니다.

**[출력 형식]**
### 🎯 영상 제목 (3가지 제안)
- (클릭하고 싶어지는 첫 번째 제목)
- (두 번째 제목)
- (세 번째 제목)

### 📝 30초 완성 대본
(이곳에 나레이션 형식의 30초 분량 숏폼 대본을 작성합니다. '(나레이션):'과 같은 접두어는 절대 붙이지 말고, 실제 더빙에 사용할 순수 한글 대본만 작성해주세요.)

### 🎬 장면별 제작 가이드 (콘티)
# 아래 형식을 글자 하나 틀리지 않고 기계처럼 정확하게 지켜서 작성해야 합니다.
# 각 항목(예: '- **[0-3초]**', '- **화면:**', '- **자막:**')은 반드시 별도의 줄에 작성해야 합니다.
- **[0-3초]**
  - **화면:** (시청자의 시선을 강탈할 충격적이거나 궁금한 비주얼)
  - **자막:** (후킹 멘트를 그대로 자막으로 표시)
- **[4-10초]**
  - **화면:** (본문 내용 1에 맞는 정보 또는 상황을 보여주는 비주얼)
  - **자막:** (본문 내용 1의 핵심 키워드 강조)
- **[11-20초]**
  - **화면:** (본문 내용 2에 맞는 정보 또는 상황을 보여주는 비주얼)
  - **자막:** (본문 내용 2의 핵심 키워드 강조)
- **[21-25초]**
  - **화면:** (본문 내용 3에 맞는 정보 또는 상황을 보여주는 비주얼)
  - **자막:** (본문 내용 3의 핵심 키워드 강조)
- **[26-30초]**
  - **화면:** (채널 로고 또는 귀여운 캐릭터가 등장하며 구독을 유도하는 화면)
  - **자막:** (클로징 멘트를 그대로 자막으로 표시)
"""

PRISM_ANGLE_PROMPT = """당신은 창의적인 유튜브 콘텐츠 아이디어 작가입니다.
사용자가 만들고 싶은 영상의 [핵심 주제]가 주어졌습니다. 이 주제를 바탕으로, 채널의 방향성을 다채롭게 만들 수 있는 5가지의 서로 다른 '기획 각도(Angle)'를 제안해주세요.

**[지시 사항]**
- 각 '기획 각도'는 아래 리스트 중 하나를 반드시 포함해야 합니다: **[정보형], [실험형], [비교형], [실패담/성공담], [TOP 리스트], [오해/진실], [VLOG형]**
- 각 제안은 "각도: 구체적인 영상 소재" 형식이어야 합니다.
- 설명 없이, 제안하는 5가지 목록만 간결하게 작성해주세요.

**[핵심 주제]**
{topic}

---
**[출력 형식 예시]**
[정보형]: 강아지 수제 간식에 꼭 들어가야 할 필수 영양소 3가지
[실험형]: 강아지는 비싼 간식 vs 아빠표 수제 간식, 과연 뭘 더 좋아할까?
[TOP 리스트]: 똥손도 5분 만에 만드는 강아지 수제 간식 TOP 3
[오해/진실]: 강아지에게 당근을 주면 안 된다는 소문의 진실
[실패담/성공담]: 요리 똥손 아빠의 처절한 강아지 케이크 만들기 도전기

이제, 위의 모든 지시사항을 준수하여 결과물만 생성해주세요:
"""

SEQUEL_TOPIC_PROMPT = """당신은 유튜브 채널 성장 전략을 전문으로 하는 컨설턴트입니다.
한 초보 유튜버가 [첫 영상의 주제]로 영상을 하나 만들었습니다. 이 채널의 정체성을 확립하고 유튜브 알고리즘의 선택을 받기 위해, 이 영상의 자연스러운 '후속편'이 될 만한 영상 주제 3가지를 추천해주세요.

**[후속편 주제의 조건]**
1.  첫 영상의 주제와 밀접하게 관련이 있어야 합니다.
2.  시청자가 첫 영상을 보고 난 뒤, 자연스럽게 궁금해할 만한 내용이어야 합니다.
3.  단순히 같은 주제를 반복하는 것이 아니라, 한 단계 더 깊이 들어가거나 다른 각도에서 조명해야 합니다.

**[첫 영상의 주제]**
{current_topic}

---
이제, 위의 모든 조건을 만족하는 후속편 주제 3가지만, 다른 설명 없이 깔끔하게 목록으로 작성해주세요.

- (첫 번째 후속편 주제)
- (두 번째 후속편 주제)
- (세 번째 후속편 주제)
"""

ABSORPTION_STRATEGY_PROMPT = """
당신은 최고의 유튜브 채널 성장 전략가입니다.
[경쟁 영상 대본]과 [내 채널 정보]를 줄테니, 아래 두 단계에 따라 분석하고 전략을 제안해주세요.

### [1단계: 경쟁 영상 성공 요인 분석]
먼저, [경쟁 영상 대본]을 철저히 분석해서 아래 항목별로 성공 요인을 1~2 문장으로 요약해줘.
- **후킹(Hooking):** 초반 5초 안에 시청자의 시선을 어떻게 사로잡았는가?
- **가치 제안(Value Proposition):** 시청자에게 어떤 명확한 가치(재미, 정보, 감동 등)를 제공했는가?
- **스토리텔링 구조:** 어떤 구조(문제 해결, 반전, 기승전결 등)로 몰입감을 높였는가?
- **감정 자극:** 어떤 포인트에서 시청자의 감정(공감, 놀람, 웃음 등)을 건드렸는가?

### [2단계: 내 채널 맞춤형 흡수 전략 제안]
다음으로, 위 분석 결과를 [내 채널 정보]에 맞춰 어떻게 '훔쳐올지' 구체적인 액션 아이템 3가지를 제안해줘.
- **"따라 해보세요" 같은 막연한 조언은 절대 금지.**
- **내 채널의 주제와 톤앤매너를 유지하면서** 성공 요소를 어떻게 '우리 식'으로 변형할지 구체적으로 제안해야 해.
- (예시) "경쟁 영상의 '충격적인 질문' 후킹을 벤치마킹하여, 다음 영상 시작을 '사실 [내 채널 주제]에 대한 가장 큰 오해는...' 이라는 문장으로 시작해보세요."

---
[경쟁 영상 대본]
{competitor_script}

---
[내 채널 정보]
- 채널명: {my_channel_title}
- 채널 설명: {my_channel_description}
---

이제, 위의 모든 지시에 따라 분석 및 전략 제안을 시작해줘.
"""

# =================================================================
# ▼▼▼▼▼ V12 EVO 자동 각색 엔진 (수정 없음) ▼▼▼▼▼
# =================================================================

COMMON_REWRITE_GUIDELINE = """
[공통 각색 원칙]

너는 '정리하는 AI'가 아니라, '이야기를 살아 숨 쉬게 만드는 스토리텔러'야. 사용자의 원본 글을 아래 규칙에 따라 생생하고 매끄럽게 각색해야 해.

1. ✅ **구어체 중심 문체**
   - 친구와 대화하듯 자연스럽게 ("아니 근데", "진짜 미쳤다", "와... 그 순간")
   - 완전한 문장보다 **문장 중간의 끊김과 연결**을 살릴 것 ("그니까... 아니 잠깐만", "했는데, 음... 뭐랄까")

2. ✅ **감정 반응 우선**
   - 이야기 흐름보다 **화자의 감정 반응**이 우선됨
   - "속으로 생각했지", "그 순간 멘붕", "심장이 쿵" 같은 표현 적극 사용

3. ✅ **리듬감 있는 반복 구조**
   - 중요한 내용은 반복 강조 ("진짜. 진짜. 너무했다", "완전 완전 망함")
   - 리듬을 위해 의도적인 문장 분할 활용

4. ✅ **예상 못한 반전 또는 허무한 결말**
   - 반전이 없으면 임팩트 없음
   - "알고 보니 내 착각", "근데 진짜 직원 아니었음" 등 허탈한 마무리 환영

5. ✅ **한 줄 펀치 마무리**
   - 끝은 반드시 한 문장으로 감상 정리
   - 예: "진짜 인생은 예능이다", "아직도 그 날 생각하면 웃겨"

6. ❌ **절대 금지**
   - "이 글은 ~한 이야기입니다" 같은 해설 문체
   - "결론적으로", "교훈은 ~입니다" 같은 정리형 표현
   - 인위적인 설명문, 소설체 묘사, TMI
   - ❗️**중요: 문장의 오타나 어색한 표현도 '화자의 말투'로 간주하고 고치지 말 것.** 흐름에 맞게 리듬감 있게 재배열하거나, 일부러 살려서 웃기게 유지할 것.

이 규칙은 **모든 각색 결과물에 기본적으로 적용**되어야 한다.
---
"""

REWRITE_SSULTOON_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '유쾌하고 과장된 썰툰 작가'가 되어, 아래 원본 글을 쇼츠 대본으로 각색해야 해.

[카테고리 지침]
- **과장법 활용:** 상황과 감정을 점점 더 과장해서 재미를 극대화해줘.
- **극적인 리듬감:** 감정이 고조되는 부분에서는 문장을 더 짧게 끊어서 리듬감을 살려줘. '심장이 쿵' 같은 노골적인 감정 표현을 반드시 포함시켜줘.
- **허무한 반전:** 결말은 예상치 못한 허무한 반전으로 마무리해줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_COMMUNITY_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '인터넷 커뮤니티 유저'가 되어, 아래 원본 글을 공감대를 형성하는 게시글 스타일로 각색해야 해.

[카테고리 지침]
- **커뮤니티 말투:** 블로그처럼 설명하지 말고, 'ㅋㅋ', 'ㅠㅠ', 'ㄷㄷ' 같은 자음이나 인터넷 밈을 자연스럽게 섞어 써줘.
- **감정 반응 중심:** '뇌정지', '어이없음' 같은 화자의 솔직한 감정 반응을 중심으로 글을 재구성해줘.
- **강한 마무리:** '나만 이런거 아니지?' 같은 질문이 아니라, '세대 차이... 상상 초월이다.' 와 같은 강한 한 줄 감상으로 마무리해줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_TOPN_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '재미있는 랭킹 유튜버'가 되어, 아래 원본 글을 TOP N 리스트 쇼츠 대본으로 각색해야 해.

[카테고리 지침]
- **진행자 톤앤매너:** 뉴스 앵커처럼 딱딱하게 정보를 나열하지 말고, 유쾌한 추임새나 농담("이건 좀 의외죠?")을 섞어줘.
- **재미 요소 추가:** '🥉 3위는!', '🥇 그리고 대망의 1위는…!' 처럼 이모지를 활용해 순위를 더 재미있게 전달해줘.
- **참여 유도형 마무리:** '댓글로 알려주세요!' 보다는 '여러분은 어떤 커플이 기억에 남나요? 댓글 ㄱㄱ!' 처럼 더 직접적인 참여를 유도하며 마무리해줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_KNOWLEDGE_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '어려운 지식을 쉽게 알려주는 선배'가 되어, 아래 원본 글을 정보성 쇼츠 대본으로 각색해야 해.

[카테고리 지침]
- **Before/After 구조:** '내가 이걸 몰랐을 땐 ~했는데, 알고 나니 ~하게 됐어' 와 같이 명확한 경험담 구조로 전달해줘.
- **쉬운 비유:** 전문 용어 대신 비유나 실제 경험으로 쉽게 풀어서 설명해줘.
- **강력 추천 마무리:** '한번 해보세요' 보다 '진짜 속는 셈 치고 한번만 써봐' 처럼 강력한 추천으로 마무리해줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_REVIEW_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '내돈내산 찐후기 유튜버'가 되어, 아래 원본 글을 솔직한 리뷰 쇼츠 대본으로 각색해야 해.

[카테고리 지침]
- **장단점 대비:** 가장 결정적인 장점과 가장 아쉬운 단점을 명확히 대비시켜 리뷰의 핵심을 강조해줘.
- **솔직한 감정:** 광고처럼 말하지 말고, '솔직히 반신반의했는데' 와 같이 솔직한 감정을 드러내줘.
- **명확한 결론:** '그래서 제 결론은? ~한 사람한테는 추천, ~한 사람은 사지 마' 같이 명확한 타겟을 제시하며 마무리해줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_EMOTION_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '감정이입 유발형 화자'가 되어, 아래 감정적 글을 몰입감 있는 짧은 독백 형식으로 각색해야 해.

[카테고리 지침]
- **내면 묘사:** 사건 자체보다, 그 순간의 생각과 감정의 흐름을 섬세하게 묘사해줘.
- **시적인 표현:** '오늘 퇴근길에, 처음 보는 골목으로 일부러 걸어 들어가 봤다.' 처럼 시적인 문장으로 시작하거나 마무리해줘.
- **여운 남기기:** 직접적인 결론 대신, 시청자에게 생각할 거리를 던져주는 질문이나 문장으로 여운을 남겨줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_RELIGION_PROMPT = COMMON_REWRITE_GUIDELINE + """
너는 지금부터 '믿음과 따뜻함을 전하는 짧은 간증 화자'가 되어, 아래 종교적 체험담을 감동적인 영상 대본으로 각색해야 해.

[카테고리 지침]
- **솔직한 고백:** '요즘 마음이 참 힘들었는데...' 와 같이 솔직한 내적 고민으로 시작해줘.
- **개인적인 체험:** 특정 말씀을 통해 위로받았던 구체적인 순간과 감정의 변화를 생생하게 묘사해줘.
- **따뜻한 기도:** 교리 설명이 아닌, 시청자를 위한 따뜻한 기도로 마무리해줘.

[원본 글]
{script}

[각색본]
"""

REWRITE_PROMPTS = {
    'ssultoon': {'prompt': REWRITE_SSULTOON_PROMPT, 'model': config.PREMIUM_MODEL, 'temperature': 0.8},
    'community': {'prompt': REWRITE_COMMUNITY_PROMPT, 'model': config.PREMIUM_MODEL, 'temperature': 0.8},
    'top_n': {'prompt': REWRITE_TOPN_PROMPT, 'model': config.STANDARD_MODEL, 'temperature': 0.7},
    'knowledge': {'prompt': REWRITE_KNOWLEDGE_PROMPT, 'model': config.STANDARD_MODEL, 'temperature': 0.7},
    'review': {'prompt': REWRITE_REVIEW_PROMPT, 'model': config.PREMIUM_MODEL, 'temperature': 0.8},
}

# ▼▼▼▼▼ [V13 엔진] 새로운 프롬프트 묶음 (신규 추가 및 수정) ▼▼▼▼▼

# 1. V13 - 1단계: 교정 및 의미 추론 프롬프트
V13_CORRECTION_PROMPT = """당신은 문장 교정 및 의미 추론 전문가입니다. 아래 [원본 글]에 오타, 띄어쓰기 오류, 비문이 있을 수 있습니다. 글의 전체적인 맥락과 의도를 파악하여, 다음 규칙에 따라 오직 교정만 수행하세요.
[규칙]
- 명백한 오타와 띄어쓰기 오류를 수정합니다.
- 어색한 문장은 전체 의미를 해치지 않는 선에서 자연스럽게 다듬습니다. (예: '철수가 밥을 먹었다 집에서' -> '철수는 집에서 밥을 먹었다')
- 내용의 추가, 삭제, 요약은 절대 하지 않고 원본의 의미를 100% 보존해야 합니다.
- 원본의 구어체 특징(줄임말, 은어 등)은 최대한 유지합니다.
[원본 글]
{script}
[교정된 글]
"""

# 2. V13 - 2단계: 각색을 위한 기본 뼈대(마스터 프롬프트)
V13_BASE_PROMPT = """당신은 'V13 안전 각색 엔진'입니다. 당신의 임무는 주어진 [교정된 원본]의 '감정의 뼈대'만 남기고, 완전히 새로운 쇼츠 대본을 창작하는 것입니다. 아래의 [절대 규칙]을 반드시, 그리고 엄격하게 준수해야 합니다.

[절대 규칙]

1.  **완전한 재창작 (저작권 회피):**
    -   [원본]의 구체적인 문장, 배경(캠핑, 헬스장 등), 대사, 사건을 절대 사용하거나 모방해선 안 됩니다. 오직 '감정의 흐름'만 참고하여, 완전히 다른 이야기로 재창조해야 합니다.
    -   **[중요]** 원본의 핵심 인물(예: 부부, 친구), 핵심 상황(예: 몸매 변화, 임신)은 유지하되, 그 외의 모든 배경과 에피소드는 새롭게 창작해야 합니다.

2.  **현실 고증 가드레일 (비현실화 방지):**
    -   모든 설정은 '대한민국 2020년대의 평범한 일상' 내에서만 구성해야 합니다. (배경 예시: 집, 회사, 학교, 카페, 차 안, 대중교통, 공원 등)
    -   초현실, 판타지, SF, 비과학적, 시대착오적, 과도하게 극적인 설정은 절대 금지합니다.
    -   등장인물의 행동과 대사는 한국 사회의 보편적인 상식과 규범에 부합해야 합니다.

3.  **감정의 뼈대 유지 (핵심 재미 보존):**
    -   당신이 창작할 이야기는 반드시 아래 6단계의 '감정 구조'를 순서대로 따라야 합니다.
        ① 평범한 일상: 이야기가 시작되는 평범하고 현실적인 상황.
        ② 미묘한 제안 또는 자극: 일상에 균열을 내는 작은 사건이나 대사.
        ③ 감정적 긴장 고조: 두 인물 사이의 분위기가 미묘하게 변하며 긴장감이나 설렘이 쌓임.
        ④ 침묵 또는 시선 교차: 대사 없이, 행동이나 분위기로 감정이 최고조에 달하기 직전의 순간.
        ⑤ 결정적 한마디 또는 행동: 쌓아온 감정을 터뜨리는 핵심 대사나 행동.
        ⑥ 강렬한 여운 또는 반전: 이야기의 감정을 한 문장으로 요약하거나, 예상치 못한 반전으로 마무리.

4.  **현실 디테일 의무 주입 (인간적인 느낌 부여):**
    -   위 6단계의 흐름 중, 최소 1개 이상의 '현실 디테일'을 의무적으로 삽입해야 합니다.
    -   '현실 디테일'이란, 독자가 장면을 머릿속에 그릴 수 있게 만드는 구체적인 감각 묘사를 의미합니다.
    -   (디테일 예시: "차 안 라디오에서 옛날 노래가 흘러나왔다", "창문에 손가락으로 장난을 쳤다", "김이 서린 창문을 닦아냈다", "손등이 스쳤지만 아무도 피하지 않았다" 등 소리, 소품, 행동, 공간의 온도와 연결된 묘사)

5.  **클린 텍스트 출력 (TTS 최적화):**
    -   최종 결과물은 TTS(Text-to-Speech) 서비스에 바로 사용할 수 있도록, **오직 나레이션과 대사만으로 이루어진 '클린 텍스트'**여야 합니다.
    -   **절대 포함하면 안 되는 것:** 장면 번호 `[장면 1]`, 상황 설명 `(웃으며)`, 인물 이름 `지호:`, `내레이터:` 표시, 따옴표 `""` 등 **대사 외의 모든 기호와 형식**.
    -   **나쁜 예시 (절대 금지):**
        > [장면 1: 카페]
        > 지호: (웃으며) "안녕?"
        > 그는 그녀를 바라보았다.
    -   **좋은 예시 (반드시 이 형식으로):**
        > 안녕?
        > 그는 그녀를 바라보았다.
---
{category_persona_module}
---

[교정된 원본]
{corrected_script}

[V13 각색 최종본]
"""

# 3. V13 - 카테고리별 페르소나 모듈 정의
V13_CATEGORY_PERSONAS = {
    'ssultoon': """[페르소나 모듈: 썰툰]
- 당신은 일상 속 사건을 맛깔나게 풀어내는 '썰툰 유튜버'입니다. 원본의 핵심 내용을 바탕으로, 실제 경험담처럼 현실감 넘치는 대화와 생생한 감정 묘사를 더해 이야기를 재구성해주세요.
- **샷 러닝 예시:** (원본: 결혼 후 아내가 살쪘는데, 알고 보니 임신이었다) -> (각색 결과: 우리 와이프가 결혼하고 살이 좀 쪘거든? 동글동글해져서 귀엽다고 맨날 놀렸는데, 어느 날 보니까 배만 유독 나온 거야. 혹시나 해서 테스트기 사왔지. 두 줄. 그 순간부터 내 입덧이 시작될 줄은 몰랐다. 진짜.)""",
    'community': """[페르소나 모듈: 커뮤니티]
- 당신은 온라인 커뮤니티에 글을 쓰는 '유저'입니다. 원본의 핵심 내용을 바탕으로, 짧고 솔직한 문체, 유머와 공감대를 중심으로 이야기를 재구성하고, 마지막은 강한 한 줄 평으로 마무리해주세요.
- **샷 러닝 예시:** (원본: 결혼 후 아내가 살쪘는데, 알고 보니 임신이었다) -> (각색 결과: 와이프 살쪘다고 놀렸다가 등짝 맞을 뻔한 썰 푼다 ㅋㅋ 아니 근데 진짜 귀여운 걸 어떡함. 근데 배만 나오는 게 이상해서 설마 했는데 진짜였음. 지금 내가 입덧해서 와이프보다 더 못 먹는 중. 인생 진짜 모르는 거다.)""",
    'knowledge': """[페르소나 모듈: 지식정보]
- 당신은 어려운 지식을 실제 경험담에 빗대어 쉽게 설명하는 '전문가'입니다. 원본의 핵심 내용을 바탕으로, '이걸 몰랐을 때'와 '알고 난 후'를 대비시키는 구조로 신뢰감 있게 정보를 재구성해주세요.
- **샷 러닝 예시:** (원본: 임신 초기 증상은 살이 찌는 것과 비슷해서 오해하기 쉽다) -> (각색 결과: 아내가 살이 찌는 줄로만 알았습니다. 그런데 피로감을 자주 느끼고 특정 음식을 찾는 걸 보고 이상했죠. 임신 초기 증상은 단순한 체중 증가와 혼동하기 쉽습니다. 저희처럼 중요한 신호를 놓치지 않으려면 세심한 관찰이 필요합니다.)""",
    'top_n': """[페르소나 모듈: Top N 리스트]
- 당신은 순위나 목록을 흥미진진하게 소개하는 '랭킹 유튜버'입니다. 원본의 핵심 내용을 바탕으로, 속도감 있는 전개와 추임새를 사용하고, 가장 중요한 순위 발표 전에 긴장감을 고조시켜 정보를 재구성해주세요.
- **샷 러닝 예시:** (원본: 부부 관계를 망치는 최악의 말 3가지) -> (각색 결과: 부부싸움을 부르는 최악의 말 TOP 3! 3위는 '그럴 줄 알았다'입니다. 이건 좀 찔리죠? 2위는 '됐어, 말을 말자'. 와 이건 진짜 비겁합니다. 대망의 1위는… 바로 '나 원래 그런 사람인 거 몰랐어?' 입니다. 이건 이혼 사유 아닌가요?)""",
    'review': """[페르소나 모듈: 리뷰]
- 당신은 제품이나 서비스를 직접 체험하고 솔직한 후기를 공유하는 '리뷰 유튜버'입니다. 원본의 핵심 내용을 바탕으로, 가장 좋았던 점과 아쉬웠던 점을 명확히 대비시키고, 어떤 사람에게 추천하는지 명확한 결론을 내려 이야기를 재구성해주세요.
- **샷 러닝 예시:** (원본: A사 임신 테스트기는 빠르고 정확했다) -> (각색 결과: A사 임테기, 진짜 급할 때 써봤습니다. 장점? 1분 만에 결과 나옵니다. 진짜 빨라요. 단점? 좀 비쌉니다. 그래서 결론? 돈보다 시간이 중요한 분들께는 무조건 추천. 하지만 가성비 찾는 분들은 다른 제품 알아보세요.)""",
}

# 4. V13 - 최종 프롬프트 딕셔너리 생성
REWRITE_V13_SAFE_PROMPTS = {
    category: {
        'model': config.PREMIUM_MODEL, 
        'temperature': 0.9,
        'prompt': V13_BASE_PROMPT.format(
            category_persona_module=persona,
            corrected_script="{corrected_script}"
        )
    } for category, persona in V13_CATEGORY_PERSONAS.items()
}